(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{432:function(_,v,e){"use strict";e.r(v);var o=e(0),a=Object(o.a)({},(function(){var _=this,v=_._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[v("blockquote",[v("p",[_._v("作者：绯影")])]),_._v(" "),v("h3",{attrs:{id:"并行"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#并行"}},[_._v("#")]),_._v(" 并行")]),_._v(" "),v("p",[v("code",[_._v("npm 5")]),_._v(" 以后是并行的，"),v("code",[_._v("npm7")]),_._v(" 及以后不再提供 "),v("code",[_._v("--no-parallel")]),_._v(" 这个选项")]),_._v(" "),v("h3",{attrs:{id:"lock-与-npm-的关系"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#lock-与-npm-的关系"}},[_._v("#")]),_._v(" .lock 与 npm 的关系")]),_._v(" "),v("ul",[v("li",[v("code",[_._v("npm update")]),_._v(" 会更新 "),v("code",[_._v("lock")]),_._v(" 文件")]),_._v(" "),v("li",[v("code",[_._v("npm install")]),_._v(" 时产生 "),v("code",[_._v("lock")]),_._v(" 文件")]),_._v(" "),v("li",[v("code",[_._v("cnpm install")]),_._v(" 不会产生 "),v("code",[_._v("lock")]),_._v(" 文件")]),_._v(" "),v("li",[_._v("当 "),v("code",[_._v("package.json")]),_._v(" 与 "),v("code",[_._v("lock")]),_._v(" 文件不兼容时，"),v("code",[_._v("npm install")]),_._v(" 会更新 "),v("code",[_._v("lock")]),_._v(" 文件；")]),_._v(" "),v("li",[v("code",[_._v("lock")]),_._v(" 兼容 "),v("code",[_._v("package.json")]),_._v(" 时（"),v("code",[_._v("lock")]),_._v(" 比较大），使用 "),v("code",[_._v("lock")]),_._v("。")]),_._v(" "),v("li",[v("code",[_._v("package.json")]),_._v(" 比 "),v("code",[_._v("lock")]),_._v(" 大时，使用 "),v("code",[_._v("package.json")])])]),_._v(" "),v("h3",{attrs:{id:"peerdependencies"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#peerdependencies"}},[_._v("#")]),_._v(" peerDependencies")]),_._v(" "),v("p",[_._v("peerDependencies 并不影响最终的安装结果，只是起到一个提示作用")]),_._v(" "),v("ul",[v("li",[_._v("yarn 里面会提示，但是不会进行阻拦")]),_._v(" "),v("li",[_._v("npm 里面会提示，同时也会进行安装阻拦。")]),_._v(" "),v("li",[_._v("pnpm 里面会提示，但是不会进行阻拦")])]),_._v(" "),v("h3",{attrs:{id:"node-modules"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#node-modules"}},[_._v("#")]),_._v(" node_modules")]),_._v(" "),v("h4",{attrs:{id:"npm2-x"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#npm2-x"}},[_._v("#")]),_._v(" npm2.x")]),_._v(" "),v("p",[_._v("嵌套 "),v("code",[_._v("node_module")]),_._v("，同样的依赖会复制很多次，"),v("code",[_._v("windows")]),_._v(" 的文件路径最长是 "),v("code",[_._v("260")]),_._v(" 多个字符，这样嵌套是会超过 "),v("code",[_._v("windows")]),_._v(" 路径的长度限制的。还没解决的时候 "),v("code",[_._v("yarn")]),_._v(" 就出来了")]),_._v(" "),v("h4",{attrs:{id:"yarn"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#yarn"}},[_._v("#")]),_._v(" yarn")]),_._v(" "),v("p",[_._v("铺平。所有的依赖不再一层层嵌套了，而是全部在同一层，大部分是没有二层 "),v("code",[_._v("node_modules")]),_._v(" 一个包是可能有多个版本的，提升只能提升一个，所以后面再遇到相同包的不同版本，依然还是用嵌套的方式。")]),_._v(" "),v("h4",{attrs:{id:"npm3-x"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#npm3-x"}},[_._v("#")]),_._v(" npm3.x")]),_._v(" "),v("p",[_._v("和 yarn 很类似")]),_._v(" "),v("p",[v("strong",[_._v("扁平化")]),_._v("的问题")]),_._v(" "),v("ul",[v("li",[v("p",[_._v("最主要的一个问题是幽灵依赖\n没有显式依赖，也能访问。存在风险，万一有一天别的包不依赖这个包了，那你的代码也就不能跑了。")])]),_._v(" "),v("li",[v("p",[_._v("就是上面提到的依赖包有多个版本的时候，只会提升一个，那其余版本的包不还是复制了很多次么")])])]),_._v(" "),v("h4",{attrs:{id:"pnpm"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#pnpm"}},[_._v("#")]),_._v(" pnpm")]),_._v(" "),v("ol",[v("li",[v("p",[_._v("如果你对同一依赖包需要使用不同的版本，则仅有 版本之间不同的文件会被存储起来。例如，如果某个依赖包包含 100 个文件，其发布了一个新 版本，并且新版本中只有一个文件有修改，则 "),v("code",[_._v("pnpm update")]),_._v(" 只需要添加一个 新文件到存储中，而不会因为一个文件的修改而保存依赖包的 所有文件。")])]),_._v(" "),v("li",[v("p",[_._v("所有文件都保存在硬盘上的统一的位置。当安装软件包时， 其包含的所有文件都会硬链接自此位置，而不会占用 额外的硬盘空间。这让你可以在项目之间方便地共享相同版本的 依赖包。然后包和包之间的依赖关系是通过软链接组织的。\n"),v("code",[_._v("node_modules")]),_._v("下面的包以及 "),v("code",[_._v("node_modules/.pnpm/xx/node_modules")]),_._v(" 里面的包 软链接到 "),v("code",[_._v("node_modules/.pnpm")])])])]),_._v(" "),v("p",[v("strong",[_._v("可以解决")])]),_._v(" "),v("ul",[v("li",[v("code",[_._v("node_modules")]),_._v(" 下只有显式安装的包，没有幽灵依赖")]),_._v(" "),v("li",[_._v("包和包之间的依赖关系是通过软链接组织的。")]),_._v(" "),v("li",[_._v("多个项目中相同的依赖将与全局 "),v("code",[_._v("store")]),_._v(" 里面的内容建立硬链接（"),v("code",[_._v("npm、yarn")]),_._v("都是每个项目安装完整的引用包）")])])])}),[],!1,null,null,null);v.default=a.exports}}]);