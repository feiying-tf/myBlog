<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端知识</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/myBlog/favicon.png">
    <meta name="description" content="记录前端面试中比较重要的知识点">
    <meta name="referrer" content="no-referrer">
    
    <link rel="preload" href="/myBlog/assets/css/0.styles.f2323daf.css" as="style"><link rel="preload" href="/myBlog/assets/js/app.abc56468.js" as="script"><link rel="preload" href="/myBlog/assets/js/3.ea42afb7.js" as="script"><link rel="preload" href="/myBlog/assets/js/1.28d3c41f.js" as="script"><link rel="preload" href="/myBlog/assets/js/36.5885b136.js" as="script"><link rel="prefetch" href="/myBlog/assets/js/10.e9fd780d.js"><link rel="prefetch" href="/myBlog/assets/js/11.15e14e7e.js"><link rel="prefetch" href="/myBlog/assets/js/12.f5885f36.js"><link rel="prefetch" href="/myBlog/assets/js/13.676178be.js"><link rel="prefetch" href="/myBlog/assets/js/14.d8619f80.js"><link rel="prefetch" href="/myBlog/assets/js/15.34ce1b42.js"><link rel="prefetch" href="/myBlog/assets/js/16.8972c9b9.js"><link rel="prefetch" href="/myBlog/assets/js/17.e9cf72df.js"><link rel="prefetch" href="/myBlog/assets/js/18.458703e6.js"><link rel="prefetch" href="/myBlog/assets/js/19.f9573a78.js"><link rel="prefetch" href="/myBlog/assets/js/20.a162aca4.js"><link rel="prefetch" href="/myBlog/assets/js/21.a1baac20.js"><link rel="prefetch" href="/myBlog/assets/js/22.40117efd.js"><link rel="prefetch" href="/myBlog/assets/js/23.15541339.js"><link rel="prefetch" href="/myBlog/assets/js/24.aae60994.js"><link rel="prefetch" href="/myBlog/assets/js/25.c5297ec5.js"><link rel="prefetch" href="/myBlog/assets/js/26.89c85458.js"><link rel="prefetch" href="/myBlog/assets/js/27.7ed165f3.js"><link rel="prefetch" href="/myBlog/assets/js/28.e9c8e0cc.js"><link rel="prefetch" href="/myBlog/assets/js/29.c0c671f2.js"><link rel="prefetch" href="/myBlog/assets/js/30.d728ea23.js"><link rel="prefetch" href="/myBlog/assets/js/31.f988a101.js"><link rel="prefetch" href="/myBlog/assets/js/32.f5816a21.js"><link rel="prefetch" href="/myBlog/assets/js/33.bf643869.js"><link rel="prefetch" href="/myBlog/assets/js/34.4bdf0691.js"><link rel="prefetch" href="/myBlog/assets/js/35.f957c9a7.js"><link rel="prefetch" href="/myBlog/assets/js/37.880d25de.js"><link rel="prefetch" href="/myBlog/assets/js/38.4ed040e3.js"><link rel="prefetch" href="/myBlog/assets/js/39.be1bafc3.js"><link rel="prefetch" href="/myBlog/assets/js/4.99264d25.js"><link rel="prefetch" href="/myBlog/assets/js/5.04bd80e5.js"><link rel="prefetch" href="/myBlog/assets/js/6.99331b86.js"><link rel="prefetch" href="/myBlog/assets/js/7.05826f29.js"><link rel="prefetch" href="/myBlog/assets/js/8.59781a33.js"><link rel="prefetch" href="/myBlog/assets/js/9.1a6b2cb8.js">
    <link rel="stylesheet" href="/myBlog/assets/css/0.styles.f2323daf.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container" data-v-2d5f533b><div data-v-2d5f533b><div id="loader-wrapper" class="loading-wrapper" data-v-d48f4d20 data-v-2d5f533b data-v-2d5f533b><div class="loader-main" data-v-d48f4d20><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div><div data-v-d48f4d20></div></div> <!----> <!----></div> <div class="password-shadow password-wrapper-out" style="display:none;" data-v-64685f0e data-v-2d5f533b data-v-2d5f533b><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e>前端知识</h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>前端知识</span>
            
          <!---->
          2023
        </a></span></div></div> <div class="hide" data-v-2d5f533b><header class="navbar" data-v-2d5f533b><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/myBlog/" class="home-link router-link-active"><!----> <span class="site-name">前端知识</span></a> <div class="links"><div class="color-picker"><a class="color-button"><i class="iconfont reco-color"></i></a> <div class="color-picker-menu" style="display:none;"><div class="mode-options"><h4 class="title">Choose mode</h4> <ul class="color-mode-options"><li class="dark">dark</li><li class="auto active">auto</li><li class="light">light</li></ul></div></div></div> <div class="search-box"><i class="iconfont reco-search"></i> <input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="https://github.com/tfeng-use" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      博客
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2013961034411288/posts" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask" data-v-2d5f533b></div> <aside class="sidebar" data-v-2d5f533b><div class="personal-info-wrapper" data-v-ca798c94 data-v-2d5f533b><!----> <h3 class="name" data-v-ca798c94>
    前端知识
  </h3> <div class="num" data-v-ca798c94><div data-v-ca798c94><h3 data-v-ca798c94>0</h3> <h6 data-v-ca798c94>文章</h6></div> <div data-v-ca798c94><h3 data-v-ca798c94>0</h3> <h6 data-v-ca798c94>标签</h6></div></div> <hr data-v-ca798c94></div> <nav class="nav-links"><div class="nav-item"><a href="https://github.com/tfeng-use" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title"><i class="iconfont undefined"></i>
      博客
    </span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="https://juejin.cn/user/2013961034411288/posts" target="_blank" rel="noopener noreferrer" class="nav-link external"><i class="iconfont undefined"></i>
  掘金
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div> <!----></nav> <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/myBlog/base/css" class="sidebar-heading clickable"><span>基础知识</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/myBlog/demo/animateToDom" class="sidebar-heading clickable"><span>Demo</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/myBlog/problemInDev/uniapp" class="sidebar-heading clickable open"><span>开发中遇到的坑</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/myBlog/problemInDev/uniapp.html" class="sidebar-link">uniapp</a></li><li><a href="/myBlog/problemInDev/h5.html" aria-current="page" class="active sidebar-link">h5</a></li><li><a href="/myBlog/problemInDev/ant-design-vue.html" class="sidebar-link">ant-design-vue</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/myBlog/interview/http" class="sidebar-heading clickable"><span>前端面试</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>技能树</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div class="password-shadow password-wrapper-in" style="display:none;" data-v-64685f0e data-v-2d5f533b><h3 class="title" style="display:none;" data-v-64685f0e data-v-64685f0e></h3> <!----> <label id="box" class="inputBox" style="display:none;" data-v-64685f0e data-v-64685f0e><input type="password" value="" data-v-64685f0e> <span data-v-64685f0e>Konck! Knock!</span> <button data-v-64685f0e>OK</button></label> <div class="footer" style="display:none;" data-v-64685f0e data-v-64685f0e><span data-v-64685f0e><i class="iconfont reco-theme" data-v-64685f0e></i> <a target="blank" href="https://vuepress-theme-reco.recoluan.com" data-v-64685f0e>vuePress-theme-reco</a></span> <span data-v-64685f0e><i class="iconfont reco-copyright" data-v-64685f0e></i> <a data-v-64685f0e><span data-v-64685f0e>前端知识</span>
            
          <!---->
          2023
        </a></span></div></div> <div data-v-2d5f533b><main class="page" style="padding-right:0;"><div class="page-title" style="display:none;"><h1 class="title"></h1> <div data-v-3b7f5bdf><i class="iconfont reco-account" data-v-3b7f5bdf><span data-v-3b7f5bdf>前端知识</span></i> <!----> <!----> <!----></div></div> <div class="theme-reco-content content__default" style="display:none;"><blockquote><p>作者：绯影</p></blockquote> <ol><li><p>当 van-popup 与 van-number-keyboard 共同使用的时候，直接设置 van-popup 的 style 的 height 属性会直接切换 van-popup
的高度，不会产生动画。
解决方法：为 van-popup 设置一个 class，然后设置为这个类设置 transition；</p></li> <li><p><code>&lt;meta name = &quot;format-detection&quot; content = &quot;telephone=no&quot;&gt;</code><br>
阻止 ios 将数字输入识别为号码从而弹出呼叫</p></li> <li><p>阻止弹出默认键盘，将 input 设置成 readonly</p></li> <li><p>h5 请求接口要用到 token，原生将 token 保存到 cookie 里面</p></li> <li><p>图片不显示用默认图片代替的方案：
（1）用一个 wrapper 将 img 进行包裹，然后设置大小以及 overflow:hidden
（2）为图片设置宽高，并将替代图片设置为背景（这儿是为了兼容 ios，因为 ios 上面图片没有加载也会占有一部分尺寸）
（3）在 img 后面放上替代图片，设置大小，当前面的图片无法显示的时候的宽高为 0，此时便可以使用 img 进行替代。</p></li> <li><p>当设置了 </p><meta id="phone" name="format-detection" content="telephone=no"> 以后，如果要调起
h5 的电话，那么就需要显示的使用 a 标签<p></p></li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">v-if</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>isH5<span class="token punctuation">&quot;</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content phone<span class="token punctuation">&quot;</span></span> <span class="token attr-name">:href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>`tel:${detail.phone}`<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">&gt;</span></span>{{detail.phone}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span>
<span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">v-else</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content phone<span class="token punctuation">&quot;</span></span> <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>handlePhone<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>{{detail.phone}}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><p>然后在 handlePhone 里面调用原生的方法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">$nativeCallPhone</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>detail<span class="token punctuation">.</span>phone<span class="token punctuation">)</span>
</code></pre></div><ol start="7"><li><p>当 van-popup 无法弹出来的时候，设置 class，然后通过类设置它的 height。</p></li> <li><p>h5 调用安卓和 ios 的相册
（1）方案 1：如果不需要前端路由，比如默认图片，那么完全可以触发一个 bridge，由原生调起拍照和相册弹窗，然后在
bus 的$on 回调里面处理传过来的图片。</p></li></ol> <p>（2）方案 2：如果需要前端路由，比如有默认图片的选择，那么就可以通过下面的 input 输入框，然后原生进行拦截操作，最终
将在 change 事件里面处理接收到的图片信息。</p> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>van-action-sheet__item van-hairline--top<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>van-action-sheet__name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>拍照<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>oInput1<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">accept</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image/*<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>showUploadType = false<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>upload<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">capture</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>camera<span class="token punctuation">&quot;</span></span>
  <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>van-action-sheet__item van-hairline--top<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>van-action-sheet__name<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>相册<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span>
    <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>oInput2<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>file<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">accept</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>image/*<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">@click</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>showUploadType = false<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">@change</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>upload<span class="token punctuation">&quot;</span></span>
    <span class="token attr-name">multiple</span>
  <span class="token punctuation">/&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="9"><li>全面屏问题</li></ol> <p>(1)设置 view-fit=cover</p> <meta name="viewport" content="initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, viewport-fit=cover">   
(2)设置安全区域，但是这种方法在 ios 上面会引起页面跳动，所以可以直接设置为固定值。
  底部和顶部的安全距离约为 40px
<div class="language-css extra-class"><pre class="language-css"><code><span class="token property">padding-bottom</span><span class="token punctuation">:</span> <span class="token function">constant</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token property">padding-bottom</span><span class="token punctuation">:</span> <span class="token function">env</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><p>(3)注意点，iphonex 设置了全面屏以后，必须保证 view 的高度大于屏幕的高度，否则在滑动页面的时候回造成下面的 fixed 定位往上移，所以设置</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">min-height</span><span class="token punctuation">:</span> <span class="token function">calc</span><span class="token punctuation">(</span>100vh + 100px<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>(4) less 下检测 x 系列的方法</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">// 对iphonex系列的适配，用法：将要设置的样式在对应的组件里面用deviceForIPhoneX包裹起来，然后调用.iPhoneXMixin()
.iPhoneXMixin()</span> <span class="token punctuation">{</span>
  <span class="token atrule"><span class="token rule">@media</span> <span class="token keyword">only</span> screen <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">device-width</span><span class="token punctuation">:</span> 375px<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">device-height</span><span class="token punctuation">:</span> 812px<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">-webkit-device-pixel-ratio</span><span class="token punctuation">:</span> 3<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
    .<span class="token function">deviceForIPhoneX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  //iphone Xs Max
  <span class="token atrule"><span class="token rule">@media</span> <span class="token keyword">only</span> screen <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">device-width</span><span class="token punctuation">:</span> 414px<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">device-height</span><span class="token punctuation">:</span> 896px<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">-webkit-device-pixel-ratio</span><span class="token punctuation">:</span> 3<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
    .<span class="token function">deviceForIPhoneX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  //iphone XR
  <span class="token atrule"><span class="token rule">@media</span> <span class="token keyword">only</span> screen <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">device-width</span><span class="token punctuation">:</span> 414px<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">device-height</span><span class="token punctuation">:</span> 896px<span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token punctuation">(</span><span class="token property">-webkit-device-pixel-ratio</span><span class="token punctuation">:</span> 2<span class="token punctuation">)</span></span> <span class="token punctuation">{</span>
    .<span class="token function">deviceForIPhoneX</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>(5)安卓端的处理方法，安卓调起 webview 的时候，将刘海的高度通过地址传递给 h5，然后 h5 根据这个高度设置 padding 值。</p> <ol start="10"><li><p>flex 内部元素设置 showPoint 无效的解决方法：<br>
在 flex = 1 的盒子上而设置 overflow: hidden;</p></li> <li><p>vant tab 的处理<br>
将 van-tabs_nav 设置为 position: absolute</p></li> <li><p>android 设置字体大小对 h5 的影响<br>
通过安卓提供的 webview.getSettings().setTextZoom(100) 进行处理</p></li> <li><p>ios 端在使用了 fastclick 以后，input 事件不灵敏的处理方式</p></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>fastclick<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function-variable function">focus</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">targetElement</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> length
  <span class="token comment">// 这是因为这些元素并没有selectionStart和selectionEnd的整型数字属性，所以一旦引用就会报错，因此排除这些属性才使用setSelectionRange方法</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>
    window<span class="token punctuation">.</span>client <span class="token operator">===</span> <span class="token string">'ios'</span> <span class="token operator">&amp;&amp;</span>
    targetElement<span class="token punctuation">.</span>setSelectionRange <span class="token operator">&amp;&amp;</span>
    targetElement<span class="token punctuation">.</span>type<span class="token punctuation">.</span><span class="token function">indexOf</span><span class="token punctuation">(</span><span class="token string">'date'</span><span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span>
    targetElement<span class="token punctuation">.</span>type <span class="token operator">!==</span> <span class="token string">'time'</span> <span class="token operator">&amp;&amp;</span>
    targetElement<span class="token punctuation">.</span>type <span class="token operator">!==</span> <span class="token string">'month'</span> <span class="token operator">&amp;&amp;</span>
    targetElement<span class="token punctuation">.</span>type <span class="token operator">!==</span> <span class="token string">'email'</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    length <span class="token operator">=</span> targetElement<span class="token punctuation">.</span>value<span class="token punctuation">.</span>length
    targetElement<span class="token punctuation">.</span><span class="token function">setSelectionRange</span><span class="token punctuation">(</span>length<span class="token punctuation">,</span> length<span class="token punctuation">)</span>
    <span class="token comment">/* 修复bug ios 11.3不弹出键盘，这里加上聚焦代码，让其强制聚焦弹出键盘 */</span>
    targetElement<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    targetElement<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="14"><li><p>vue 项目中将一些数据文件不进行打包<br>
（1）将这些数据以 js 格式保存在 public 里面；<br>
（2）在 public 的 index.html 里面进行引入；<br>
（3）此时，这些 js 文件定义的变量将以全局变量的方式被其他 js 文件引用。</p></li> <li><p>一个盒子的两个子元素分别在左边和右边，左边元素太长显示...</p></li></ol> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.wrapper</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token selector">.left</span> <span class="token punctuation">{</span>
    <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
    .<span class="token function">showPoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token selector">.right</span> <span class="token punctuation">{</span>
    <span class="token property">flex</span><span class="token punctuation">:</span> 0 36px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="16"><li>纯 http 获取 url 转换为 base64</li></ol> <div class="language-ls extra-class"><pre class="language-text"><code>getURLBase64(url) {
return new Promise((resolve, reject) =&gt; {
  var xhr = new XMLHttpRequest();
  xhr.open(&quot;get&quot;, url, true);
  xhr.responseType = &quot;blob&quot;;
  xhr.onload = function() {
    if (this.status === 200) {
      var blob = this.response;
      var fileReader = new FileReader();
      fileReader.onloadend = function(e) {
        var result = e.target.result;
        resolve(result);
      };
      fileReader.readAsDataURL(blob);
    }
  };
  xhr.onerror = function() {
    reject();
  };
  xhr.send();
});
}
</code></pre></div><ol start="17"><li><p>处理刘海屏的时候，如果是完全全面屏，则需要根据是否有刘海屏进行处理，如果可以保留上面的时间调，只是将返回部分去掉，直接让移动端进行设置，h5 可以在打开当前页面的时候传入某个参数，让移动端检测这个参数，从而控制隐藏上面的 bar。</p></li> <li><p>vant 多列表中下拉刷新 + 缺省页<br>
（1）下拉刷新避免出现两个 loading，将 list 的 loading 置为 false，同时将 list 的 finished 置为 true；<br>
（2）显示缺省页的条件</p></li></ol> <ul><li>list 长度为 0 &amp;&amp; 没有在请求中（上拉加载）；</li> <li>list 长度为 0 &amp;&amp; 在下拉刷新中；
（3）判断没有更多的条件，如果 list.length&gt;0 就显示文字，否则就为空；</li></ul> <ol start="19"><li>下载方案，触发事件后，执行下面的 click 事件</li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span>
  <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>downloadA<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>XXXX<span class="token punctuation">&quot;</span></span>
  <span class="token attr-name">download</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>InterBullion-prod-release-0.9.1.apk<span class="token punctuation">&quot;</span></span>
<span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>

document.getElementById('downloadA').click()
</code></pre></div><ol start="20"><li>比较版本号<br>
通过下面的方式进行存储</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>table <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token string-property property">'0.9.1'</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span>
  <span class="token string-property property">'0.9.2'</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="21"><li>安卓小键盘弹起，fixed 定位偏移<br>
解决思路：通过 resize 检测屏幕的变化，屏幕变断，说明弹窗弹起，屏幕变高说明弹窗收起</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 首先判断是否是android端</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>isAndroid <span class="token operator">=</span> window<span class="token punctuation">.</span>client <span class="token operator">===</span> <span class="token string">'android'</span>
<span class="token comment">// 判断弹窗是否弹起</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>clientHeight <span class="token operator">-</span> <span class="token number">50</span> <span class="token operator">&gt;</span> document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientHeight<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>isKeyboardUp <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>isKeyboardUp <span class="token operator">=</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>
</code></pre></div><p>弹窗弹起，可以隐藏 fixed 定位，然后通过一个替代元素放到页面的最下面，这样当滑动到底部的时候，依然可以对这个元素进行操作</p> <ol start="22"><li>判断同源的方法，巧妙应用 a 标签</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getMsgOfUrl</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">url</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> a <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
  a<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'href'</span><span class="token punctuation">,</span> url<span class="token punctuation">)</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> host<span class="token punctuation">,</span> port<span class="token punctuation">,</span> protocol <span class="token punctuation">}</span> <span class="token operator">=</span> a
  <span class="token keyword">return</span> <span class="token punctuation">{</span>
    host<span class="token punctuation">,</span>
    port<span class="token punctuation">,</span>
    protocol<span class="token punctuation">,</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><p>然后分别比较两个 url 的 host，port，protocol</p> <ol start="23"><li>获取 cookie 中的值，巧妙应用 URLSearchParams 构造函数</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">getCookieValue</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">name</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 将cookie转为paramsString的格式</span>
  <span class="token keyword">let</span> cookieToParams <span class="token operator">=</span> document<span class="token punctuation">.</span>cookie<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">; </span><span class="token regex-delimiter">/</span><span class="token regex-flags">g</span></span><span class="token punctuation">,</span> <span class="token string">'&amp;'</span><span class="token punctuation">)</span>
  <span class="token keyword">let</span> cookieParams <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">URLSearchParams</span><span class="token punctuation">(</span>cookieToParams<span class="token punctuation">)</span>
  <span class="token keyword">return</span> cookieParams<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="24"><li>npm view XXX，查看某个包是否已经安装</li> <li>在 package.json 中的&quot;script&quot;，执行每个脚本的时候，默认都会执行对应的 pre 脚本，比如执行 <code>npm run build</code>执行之前会默认执行 <code>npm run prebuild</code></li> <li>使用脚本工具上传 npm 包</li></ol> <ul><li>在 package 中的 scripts 添加代码</li></ul> <div class="language-json extra-class"><pre class="language-json"><code>  <span class="token property">&quot;prepub&quot;</span><span class="token operator">:</span> <span class="token string">&quot;npm run build&quot;</span><span class="token punctuation">,</span>
  <span class="token property">&quot;pub&quot;</span><span class="token operator">:</span> <span class="token string">&quot;sh release.sh&quot;</span>
</code></pre></div><ul><li>编写脚本工具</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token shebang important">#!/user/bin/env sh</span>
<span class="token builtin class-name">set</span> -e
<span class="token builtin class-name">echo</span> <span class="token string">&quot;Enter release version: &quot;</span>
<span class="token builtin class-name">read</span> VERSION
<span class="token builtin class-name">read</span> -p <span class="token string">&quot;Releasing <span class="token variable">$VERSION</span> - are you sure? (y/n)&quot;</span> -n <span class="token number">1</span> -r
<span class="token builtin class-name">echo</span> <span class="token comment"># (optional) move to a new line</span>
<span class="token keyword">if</span> <span class="token punctuation">[</span><span class="token punctuation">[</span> <span class="token environment constant">$REPLY</span> <span class="token operator">=~</span> ^<span class="token punctuation">[</span>Yy<span class="token punctuation">]</span>$ <span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">then</span>
  <span class="token builtin class-name">echo</span> <span class="token string">&quot;Releasing <span class="token variable">$VERSION</span> ...&quot;</span>
  <span class="token comment"># commit</span>
  <span class="token function">git</span> <span class="token function">add</span> -A
  <span class="token function">git</span> commit -m <span class="token string">&quot;[build] <span class="token variable">$VERSION</span>&quot;</span>
  <span class="token function">npm</span> version <span class="token variable">$VERSION</span> --message <span class="token string">&quot;[release] <span class="token variable">$VERSION</span>&quot;</span>
  <span class="token function">git</span> push origin master

  <span class="token comment">#publish</span>
  <span class="token function">npm</span> publish
<span class="token keyword">fi</span>
</code></pre></div><ul><li>执行代码</li></ul> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">npm</span> run pub
</code></pre></div><ol start="27"><li><p>没有通过打包的静态资源部署<br>
每次修改了静态文件之后，为了避免缓存造成的干扰，在静态资源文件后面添加上 <code>?v=对应的版本号</code> 然后进行部署</p></li> <li><p>在.ts 中引入 .vue 文件，需要在 types 里面新建 shims-vue.d.ts</p></li></ol> <div class="language-ts extra-class"><pre class="language-ts"><code><span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'*.vue'</span> <span class="token punctuation">{</span>
  <span class="token keyword">import</span> Vue <span class="token keyword">from</span> <span class="token string">'vue'</span>
  <span class="token keyword">export</span> <span class="token keyword">default</span> Vue
<span class="token punctuation">}</span>
</code></pre></div><ol start="29"><li>rollup 只适合写纯 js 库</li> <li>对 inline 元素无法进行 scale，可以将其转换为 inline-block 元素</li> <li>在 html 里面唤起微信的方法，<a href="https://www.zhihu.com/question/30616809" target="_blank" rel="noopener noreferrer">相关 schema<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>weixin://<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>打开微信<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>weixin://dl/business/?ticket=xxx<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>微信内打开网页<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="31"><li>ios 安全区域的设置原理</li></ol> <ul><li>首先设置新的 meta</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>viewport<span class="token punctuation">&quot;</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>... viewport-fit=cover<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><ul><li>ios 要设置成全面屏模式</li> <li>调用 env 方法</li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token function">env</span><span class="token punctuation">(</span>safe-area-inset-top<span class="token punctuation">,</span> 20px<span class="token punctuation">)</span>
<span class="token function">env</span><span class="token punctuation">(</span>safe-area-inset-right<span class="token punctuation">,</span> 20px<span class="token punctuation">)</span>
<span class="token function">env</span><span class="token punctuation">(</span>safe-area-inset-bottom<span class="token punctuation">,</span> 20px<span class="token punctuation">)</span>
<span class="token function">env</span><span class="token punctuation">(</span>safe-area-inset-left<span class="token punctuation">,</span> 20px<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="32"><li><p>h5 在安卓与 ios 中 border 取 0.5px 的问题<br>
在 android 中，不支持 border-width: 0.5px; 所以这儿通过 box-shadow 进行兼容（这行代码在 ios 上不支持，所以刚好互补）</p></li> <li><p>通过服务器渲染的方式处理白屏（vue-press 的思路）</p></li></ol> <ul><li>每一个页面都打包成 html</li> <li>每一个 html 都引入所有的 js 和 css</li> <li>处理 js 的方式都采用 preload 的方式，在 html 的最后再使用 script 进行引入</li> <li>这样就可以处理首页白屏的问题</li></ul> <ol start="34"><li>vue 组件使用自定义 svg 组件</li></ol> <ul><li>如果定义 svg 的 js 文件里面有引入某个文件下面所有 svg 文件的操作；
那么这些文件最终都会被打包到 app.js 里面，所以需要删除掉那些大的 svg 文件，用图片进行代替。</li> <li>同时为了避免所有的 svg 都被打包到 app.js，可以在使用的时候才引入 svg</li></ul> <ol start="35"><li>使用 this.$router.go(-1)的时候传递参数：</li></ol> <ul><li>可以结合观察者模式 bus</li></ul> <div class="language-js extra-class"><pre class="language-js"><code> <span class="token function">goback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    eventBus<span class="token punctuation">.</span><span class="token function">$emit</span><span class="token punctuation">(</span><span class="token string">'onChange'</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">//调用router回退页面</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$router<span class="token punctuation">.</span><span class="token function">go</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>在另外一个页面</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>eventBus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'onChange'</span><span class="token punctuation">,</span> <span class="token parameter">data</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><ol start="36"><li>当在 ios 中使用 transform 的时候，transform 里面的元素 fixed 将失效，会变成 absolute 定位。<br>
解决方法：对于在底部的 fixed 定位可以在页面通过 bus 注册一个事件，控制底部 fixed 定位的显隐，动画完成以后才显示。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">activated</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>busFlag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      busFlag <span class="token operator">=</span> <span class="token boolean">true</span>
      bus<span class="token punctuation">.</span><span class="token function">$on</span><span class="token punctuation">(</span><span class="token string">'good_detail_return'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>detailReturn<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 主要为了处理andorid端通过快捷键进行返回</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>client <span class="token operator">===</span> <span class="token string">'android'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">detailReturn</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
   <span class="token function">detailReturn</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>showPublic <span class="token operator">=</span> <span class="token boolean">false</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>showPublic <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="37"><li>路由加了 transition 后的表现</li></ol> <ul><li>scrollBehavior 是在 activated 后面执行</li> <li>在使用 transition 切换页面时，如果页面很长，页面切换完成，页面会发生向上跳动现象</li></ul> <p>解决方法：将当前路由的最外层组件。设置为 position: relative；</p> <ul><li>如果页面很长，倘若不使用 transition，同时不使用 position.relative
页面不会发生滚动现象</li> <li>返回到 keep-Alive 的组件，只能等动画结束以后才能设置它的滚动</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">resolve</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">x</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
      <span class="token literal-property property">y</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> animationTime<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol start="38"><li>dependencies 与 devDependencies 的区别</li></ol> <ul><li>语义上面比较好区分；</li> <li>在安装一个新包的时候，它对应的 dependencies 会被同步安装，而 devDependencies 不会；</li> <li>npm install xx，会被安装，但是不会修改被加入到 package.json 里面</li> <li>加了 --save, --save-dev 才会被加入到 package.json 里面</li> <li>如果开发的不是一个包，那么安装在 dependencies 和 devDependencies 里面的包本质上区别</li></ul> <ol start="39"><li><p>vuedraggable 在移动端与 click 事件冲突的问题<br> <a href="https://juejin.im/post/5e9713946fb9a03c73798bb1" target="_blank" rel="noopener noreferrer">链接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p></li> <li><p>iframe 进行通信</p></li></ol> <ul><li>注册事件</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 这儿最好使用全局的函数，this.xxx 函数如果没有设置keepAlive，由于清除的不是同一个函数，将会造成多次注册</span>
<span class="token function">created</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$fn<span class="token punctuation">.</span>testReturn<span class="token punctuation">)</span>
    window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$fn<span class="token punctuation">.</span>testReturn<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>在 iframe 里面触发事件</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 第二个参数是要发向的连接</span>
<span class="token function">handleBtn</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  window<span class="token punctuation">.</span>parent<span class="token punctuation">.</span><span class="token function">postMessage</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> <span class="token string">'*'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li>设置样式</li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">iframe</span> <span class="token punctuation">{</span>
  <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100vw<span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ul><li><p>如果由于跨域问题无法与子 iframe 通信，那么就通过设置 url 参数的方式
https://www.cnblogs.com/itliucheng/p/4917518.html
（1）直接访问 iframe 会报跨域：window.opener，但是可以正常使用：window.opener.postMsg(msg, '*')</p></li> <li><p>vue 里面使用 iframe 即使是使用 v-if 也会重用，所以可以通过设置 key 的方式达到重用的效果。</p></li></ul> <ol start="51"><li>设置微信浏览器里面的分享为卡片式</li></ol> <ul><li>debug 提示的是{&quot;errMsg&quot;: &quot;config:ok&quot;}就说明 config 设置成功了</li> <li>官网地址
https://developers.weixin.qq.com/doc/offiaccount/OA_Web_Apps/JS-SDK.html#0</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">initWxConfig</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> url <span class="token operator">=</span> location<span class="token punctuation">.</span>href<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">'#'</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>hasInitWeiXin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span>
  <span class="token punctuation">}</span>
  <span class="token function">getWxConfig</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    url
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> res<span class="token punctuation">.</span>data
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>data<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span>
    <span class="token punctuation">}</span>
    wx<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">debug</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token comment">// 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。</span>
      <span class="token literal-property property">appId</span><span class="token operator">:</span> data<span class="token punctuation">.</span>appId<span class="token punctuation">,</span> <span class="token comment">// 必填，公众号的唯一标识</span>
      <span class="token literal-property property">timestamp</span><span class="token operator">:</span> data<span class="token punctuation">.</span>timestamp<span class="token punctuation">,</span> <span class="token comment">// 必填，生成签名的时间戳</span>
      <span class="token literal-property property">nonceStr</span><span class="token operator">:</span> data<span class="token punctuation">.</span>noncestr<span class="token punctuation">,</span> <span class="token comment">// 必填，生成签名的随机串</span>
      <span class="token literal-property property">signature</span><span class="token operator">:</span> data<span class="token punctuation">.</span>signature<span class="token punctuation">,</span> <span class="token comment">// 必填，签名，见附录1</span>
      <span class="token literal-property property">jsApiList</span><span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token string">'onMenuShareTimeline'</span><span class="token punctuation">,</span> <span class="token comment">// 将被废弃</span>
        <span class="token string">'onMenuShareAppMessage'</span><span class="token punctuation">,</span> <span class="token comment">// 将被废弃</span>
        <span class="token string">'updateAppMessageShareData'</span><span class="token punctuation">,</span> <span class="token comment">// 分享给朋友 及 分享到qq</span>
        <span class="token string">'updateTimelineShareData'</span><span class="token punctuation">,</span> <span class="token comment">// 分享到朋友圈 及 分享到qq空间</span>
        <span class="token string">'showMenuItems'</span><span class="token punctuation">,</span> <span class="token comment">// 批量显示功能按钮接口</span>
        <span class="token string">'hideMenuItems'</span><span class="token punctuation">,</span> <span class="token comment">// 批量隐藏功能按钮接口</span>
        <span class="token string">'previewImage'</span> <span class="token comment">// 预览图片接口</span>
      <span class="token punctuation">]</span> <span class="token comment">// 必填，需要使用的JS接口列表，所有JS接口列表见附录2</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    wx<span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> option <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getShareOption</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>hasInitWeiXin <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token keyword">let</span> options <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">title</span><span class="token operator">:</span> option<span class="token punctuation">.</span>title<span class="token punctuation">,</span> <span class="token comment">// 分享标题</span>
        <span class="token literal-property property">desc</span><span class="token operator">:</span> option<span class="token punctuation">.</span>desc<span class="token punctuation">,</span> <span class="token comment">// 分享描述</span>
        <span class="token literal-property property">link</span><span class="token operator">:</span> option<span class="token punctuation">.</span>url<span class="token punctuation">,</span> <span class="token comment">// 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致</span>
        <span class="token literal-property property">imgUrl</span><span class="token operator">:</span> option<span class="token punctuation">.</span>iconUrl<span class="token punctuation">,</span> <span class="token comment">// 分享图标</span>
        <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 用户点击了分享后执行的回调函数</span>
          console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'分享成功了'</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 要隐藏的菜单项，只能隐藏“传播类”和“保护类”按钮，所有menu项见附录3</span>
      <span class="token comment">// wx.hideAllNonBaseMenuItem()</span>
      wx<span class="token punctuation">.</span><span class="token function">hideMenuItems</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token literal-property property">menuList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'menuItem:copyUrl'</span><span class="token punctuation">]</span> <span class="token comment">// 隐藏复制链接</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      wx<span class="token punctuation">.</span><span class="token function">showMenuItems</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        <span class="token comment">// 要显示的菜单项，所有menu项见附录3</span>
        <span class="token literal-property property">menuList</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'menuItem:share:appMessage'</span><span class="token punctuation">,</span> <span class="token string">'menuItem:share:timeline'</span><span class="token punctuation">]</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token comment">// 朋友</span>
      wx<span class="token punctuation">.</span><span class="token function">updateAppMessageShareData</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
      <span class="token comment">// 朋友圈</span>
      wx<span class="token punctuation">.</span><span class="token function">updateTimelineShareData</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>

      <span class="token comment">// 朋友（将被废弃的接口）</span>
      wx<span class="token punctuation">.</span><span class="token function">onMenuShareAppMessage</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
      <span class="token comment">// 朋友圈（将被废弃的接口）</span>
      wx<span class="token punctuation">.</span><span class="token function">onMenuShareTimeline</span><span class="token punctuation">(</span>options<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre></div><ol start="52"><li>移动端 h5 (ios) :active 样式无效</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'touchstart'</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
</code></pre></div><ol start="57"><li>ios 验证码自动填充两次<br>
（1）当在<code>&lt;input type=&quot;text&quot;&gt; 或&lt;input type=&quot;password&quot;&gt;</code> 的情况下，可以用 maxlength 控制长度<br>
（2）当在<code>&lt;input type=&quot;number&quot;&gt;</code>时，maxlength 失效，这时候建议用</li></ol> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>number<span class="token punctuation">&quot;</span></span> <span class="token attr-name">oninput</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>if(value.length&gt;6)value=value.slice(0,6)<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
</code></pre></div><ol start="58"><li>输入框点击 closeIcon 的时候保持聚焦，在失去焦点的时候进行一个延时。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">handleCloseIcon</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span>phone <span class="token operator">=</span> <span class="token string">''</span>
  <span class="token comment">// 如果输入框数聚焦的，那么就保持聚焦</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>phoneFocus<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>phone<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>codeFocus<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>code<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">handleFocus</span> <span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'phone'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>phoneFocus <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'code'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>codeFocus <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token function">handleBlur</span> <span class="token punctuation">(</span><span class="token parameter">type</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 延迟20ms，为了避免是点击closeIcon造成的失去焦点</span>
  <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'phone'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>phoneFocus <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">===</span> <span class="token string">'code'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>codeFocus <span class="token operator">=</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="59"><li>input 框自动填充，背景变成黄色</li></ol> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">input:-webkit-autofill</span> <span class="token punctuation">{</span>
  <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 0 0px 1000px white inset <span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">input:-webkit-autofill,
textarea:-webkit-autofill,
select:-webkit-autofill</span> <span class="token punctuation">{</span>
  <span class="token property">-webkit-box-shadow</span><span class="token punctuation">:</span> 0 0 0 1000px white inset <span class="token important">!important</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">input:-webkit-autofill,
input:-webkit-autofill:hover,
input:-webkit-autofill:focus,
input:-webkit-autofill:active</span> <span class="token punctuation">{</span>
  <span class="token property">-webkit-transition-delay</span><span class="token punctuation">:</span> 99999s<span class="token punctuation">;</span>
  <span class="token property">-webkit-transition</span><span class="token punctuation">:</span> color 99999s ease-out<span class="token punctuation">,</span> background-color 99999s ease-out<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="60"><li>图片下载方案</li></ol> <p><a href="https://www.bilibili.com/read/cv5130139?from=search" target="_blank" rel="noopener noreferrer">https://www.bilibili.com/read/cv5130139?from=search<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <ol start="61"><li><p>如果遇到 cookie 无法删除的情况，那么就将其设置为空</p></li> <li><p>设置滚动条透明（兼容火狐浏览器）</p></li></ol> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.theme-czjt</span> <span class="token punctuation">{</span>
  <span class="token property">overflow-y</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
  <span class="token property">max-height</span><span class="token punctuation">:</span> 600px<span class="token punctuation">;</span>

  <span class="token comment">/* 这种方式可以兼容谷歌、欧朋等其他浏览器*/</span>
  <span class="token selector">&amp;::-webkit-scrollbar</span> <span class="token punctuation">{</span>
    <span class="token comment">/*滚动条整体样式*/</span>
    <span class="token property">width</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
    <span class="token comment">/*高宽分别对应横竖滚动条的尺寸*/</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">&amp;::-webkit-scrollbar-thumb</span> <span class="token punctuation">{</span>
    <span class="token comment">/*滚动条里面小方块*/</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">&amp;::-webkit-scrollbar-track</span> <span class="token punctuation">{</span>
    <span class="token comment">/*滚动条里面轨道*/</span>
    <span class="token property">border-radius</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  // 这儿主要针对火狐浏览器
  <span class="token property">scrollbar-color</span><span class="token punctuation">:</span> transparent<span class="token punctuation">;</span>

  <span class="token selector">&amp; &gt; div</span> <span class="token punctuation">{</span>
    <span class="token property">scrollbar-color</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="63"><li><p>要想设置 h5 在 ios 里面不能滚动，就设置 wrapper 为 position: fixed</p></li> <li><p>要避免 h5 在 ios 里面滚动穿透的问题，蒙层里面可以引入 better-scroll，当蒙层弹起的时候设置父组件的 wrapper 为 position: fixed，防止父元素发生滚动。</p></li> <li><p>获取 dom 距离窗口顶部的位置</p></li></ol> <div class="language-js extra-class"><pre class="language-js"><code>ele<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>top
ele<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>left
</code></pre></div><ol start="66"><li><p>在使用 vue 时，引入 gif，通过 v-if 或者设置 key 的方式并不会重新加载 gif，解决方法：给 gif 的地址加上?time=XXX，这样就会去重新进行加载</p></li> <li><p>如果 childDom 设置了 flex: 1，它的子元素过长依旧会将 child 撑开，处理方式设置父元素 min-height: 0；如果要作用与水平方向就是 min-width: 0;</p></li> <li><p>在 微信浏览器上面播放 video 视频，上面如果不想用户可以控制视频，可以设置 playsinline、 webkit-playsinline 属性</p></li> <li><p>在微信浏览器里面要想触发视频播放</p></li></ol> <ul><li>必须在点击事件 1s 以内触发 play()，否则将无法播放视频</li> <li>当通过 touch 事件触发动画的时候，可以在 touchStart 的时候加载动画，touchEnd de 时候将动画设置为 0，然后重新执行 play()，千万不能将动画设置一个 key，然后将 key 设置为不同的，那样在微信浏览器上面可能不会显示。</li> <li>有时候在电脑上面动画不播放，可以设置一个 key，注意不要与第二点冲突</li></ul> <ol start="70"><li>微信浏览器播放视频问题</li></ol> <ul><li>在 h5 中播放动画千万不要用 gif，在微信浏览器中会被卡死。</li> <li>在微信浏览器中，一进入浏览器可以通过下面的方式触发动画（仅限 ios）</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span>
  <span class="token string">'WeixinJSBridgeReady'</span><span class="token punctuation">,</span>
  <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>audio<span class="token punctuation">.</span><span class="token function">play</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token boolean">false</span>
<span class="token punctuation">)</span>
</code></pre></div><ul><li>避免 ios 端默认全屏播放，在 video 中设置下面的属性</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">playsinline</span> <span class="token attr-name">webkit-playsinline</span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>避免 android 全面屏播放，在 video 中设置下面属性，但是此时无法设置滤镜、无法绘制 canvas、、无法通过 touch 事件触发、无法去掉播放时存在的控件（小米）</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>video</span> <span class="token attr-name">x5-playsinline</span> <span class="token attr-name">x-webkit-airplay</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>allow<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>video</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>在 android 里面想要保持 video 的 h5 特性，比如绘制 canvas、可以设置滤镜、可以隐藏掉播放时候的空间、可以通过 touch 事件触发、但是此时没法阻止视频播放的时候自动放大</li></ul> <div class="language- extra-class"><pre class="language-text"><code>x5-video-player-type=&quot;h5&quot;
x5-video-player-fullscreen=&quot;false&quot;
</code></pre></div><ul><li><p>小米手机要给视频设置固定的高度</p></li> <li><p>在 ended 事件发生时强制页面跳转到另一个结果页（如果页面是全面屏的情况下）</p></li> <li><p>视频相关的属性，查看 HTMLMediaElement
https://developer.mozilla.org/zh-CN/docs/Web/API/HTMLMediaElement</p></li> <li><p>把视频放到腾讯云上（无法解决微信的问题）</p></li> <li><p>采用微信的播放器（无法解决微信的问题）</p></li> <li><p>封面图
（1）video 的 poster 属性（解决视频播放完毕以后 poster 无效的方法：播放完毕以后改变对应组件的 key）
（2）用一张图片代替</p></li> <li><p>时间重置</p></li></ul> <div class="language-js extra-class"><pre class="language-js"><code>videoEle<span class="token punctuation">.</span>currentTime <span class="token operator">=</span> <span class="token number">0</span>
</code></pre></div><ul><li><p>刚开始静音，要想让视频拥有声音，需要将 muted 设置为 false</p></li> <li><p>在 vant 的 swipe 组件里面的视频播放完毕以后，设置的相对于视频的 icon 在滑动的时候会隐藏的问题。首先给每个 van-swipe-item 设置不同的 key，当播放完毕以后修改对应 item 的 key。
（1）该操作也可以从 ios 的全屏模式退出（小米部分机型不行）</p></li> <li><p>video 的 object-fit 的属性应用</p></li></ul> <div class="language- extra-class"><pre class="language-text"><code>以下为object-fit属性，可以都尝试下效果看看哪种是你比较喜欢的铺满效果（值得注意的是IE浏览器不兼容此属性）
object-fit关键属性：
object-fit：fill
被替换的内容大小可以填充元素的内容框。 整个对象将完全填充此框。 如果对象的高宽比不匹配其框的宽高比，那么该对象将被拉伸以适应（会变形）。
object-fit:container
被替换的内容将被缩放，以在填充元素的内容框时保持其宽高比。 整个对象在填充盒子的同时保留其长宽比，因此如果宽高比与框的宽高比不匹配，该对象将被添加“黑边”。
object-fit:cover
被替换的内容大小保持其宽高比，同时填充元素的整个内容框。 如果对象的宽高比与盒子的宽高比不匹配，该对象将被剪裁以适应。
object-fit:none
被替换的内容尺寸不会被改变。
object-fit:scale-down
内容的尺寸就像是指定了none或contain，取决于哪一个将导致更小的对象尺寸
</code></pre></div><ol start="73"><li>下载</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 通过url获取图片的base64</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getURLBase64</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve<span class="token punctuation">,</span> reject</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> xhr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">XMLHttpRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    xhr<span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token string">'get'</span><span class="token punctuation">,</span> url<span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
    xhr<span class="token punctuation">.</span>responseType <span class="token operator">=</span> <span class="token string">'blob'</span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onload</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>status <span class="token operator">===</span> <span class="token number">200</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">var</span> blob <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>response
        <span class="token keyword">var</span> fileReader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileReader</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        fileReader<span class="token punctuation">.</span><span class="token function-variable function">onloadend</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">var</span> result <span class="token operator">=</span> e<span class="token punctuation">.</span>target<span class="token punctuation">.</span>result
          <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
        fileReader<span class="token punctuation">.</span><span class="token function">readAsDataURL</span><span class="token punctuation">(</span>blob<span class="token punctuation">)</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    xhr<span class="token punctuation">.</span><span class="token function-variable function">onerror</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">reject</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    xhr<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 下载文件</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">download</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> name <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token function">getSourceName</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span>
  <span class="token function">getURLBase64</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> link <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'a'</span><span class="token punctuation">)</span>
    <span class="token comment">// 设置下载的文件名</span>
    link<span class="token punctuation">.</span>download <span class="token operator">=</span> name
    link<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">'none'</span>
    link<span class="token punctuation">.</span>target <span class="token operator">=</span> <span class="token string">'_blank'</span>
    <span class="token comment">// 设置下载路径</span>
    link<span class="token punctuation">.</span>href <span class="token operator">=</span> res
    <span class="token comment">// 触发点击</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span>
    link<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token comment">// 移除节点</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="74"><li>h5 如果在安卓的微信浏览器很快，在 ios 的微信浏览器很慢，那么很有可能是证书过期问题。（由运维进行协作处理）</li> <li>移动端微信浏览器</li></ol> <ul><li>最外层元素 fixed 定位<br>
ios：<br>
优点：可以固定，整体页面不会跟着滚动；<br>
缺点：内部的元素有时候会滚动失效（解决方案：引入 better-scroll），如果内部元素嵌入了 iframe，引入 better-scroll 又会造成 iframe 里面的页面滚动间隙性失效。引入 better-scroll 后，在 ios13.4 以后，滑动回弹时，会造成页面跳动，解决方案，初始化 better-scroll 的时候设置：</li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">bounce:</span> <span class="token punctuation">{</span>
    <span class="token property">top</span><span class="token punctuation">:</span> false<span class="token punctuation">,</span>
    <span class="token property">bottom</span><span class="token punctuation">:</span> false
<span class="token punctuation">}</span>
</code></pre></div><ul><li>最外层其他定位<br>
ios：<br>
优点：滚动不会出现失效的情况<br>
缺点：有时，拖动时会造成整个页面都滚动<br>
android：不管最外层怎么定位，都可以把整体页面往下拖动，同时 android 上面滑动的时候默认不会有回弹效果，引入 better-scroll 的时候可以模拟回弹效果</li></ul> <ol start="75"><li>使用 npm install 时后面加上 --unsafe-perm，会忽略掉用户的权限问题引起的安装问题（特别是安装 puppeteer 的时候）</li> <li>网页留言 --&gt; 引入美洽</li> <li>分享，通过接口请求配置参数的时候，有#时，必须是#前面的所有部分，没有#就必须是当前的整个 url
（1）在 history 模式，android 分享的是首页，ios 分享无法确定
（2）如果是 hash 模式分享的链接可以通过 option 里面的 link 进行设置</li> <li>分享字体变大问题
-webkit-text-size-adjust: none;
对于图片的处理，必须给图片设置固定的宽度，例如： <code>width: 100vh</code></li> <li>预加载处理，多页面配置问题
vue.config.js<br>
之所以定位到其他路由通过右键查看源代码，可以看到 html 里面的内容也有，是因为查看源代码的时候是打开的新的页面，这个页面会重新拉对应的 html，从而可以看到对应预渲染的 html 内容。</li></ol> <div class="language-js extra-class"><pre class="language-js"><code>config<span class="token punctuation">.</span>plugins<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>
  <span class="token keyword">new</span> <span class="token class-name">PrerenderSPAPlugin</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// 生成文件的路径，也可以与webpakc打包的一致。</span>
    <span class="token literal-property property">staticDir</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'dist'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token literal-property property">routes</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token string">'/merchant'</span><span class="token punctuation">,</span> <span class="token string">'/client'</span><span class="token punctuation">,</span> <span class="token string">'/quotes'</span><span class="token punctuation">,</span> <span class="token string">'/aboutUs'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 如果这儿没有包含所有的路由，那么没有生成页面的路由需要运维设置一下，重定向到首页</span>
    <span class="token literal-property property">renderer</span><span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Renderer</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token comment">// headless: true,</span>
      <span class="token comment">// renderAfterDocumentEvent: 'render-event' // 单个可以设置这个，多路由的话，这句话会报错building for production...[prerender-spa-plugin] Unable to prerender all routes!</span>
      <span class="token literal-property property">renderAfterTime</span><span class="token operator">:</span> <span class="token number">5000</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div><p>main.js</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">new</span> <span class="token class-name">Vue</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  router<span class="token punctuation">,</span>
  store<span class="token punctuation">,</span>
  <span class="token function-variable function">render</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter">h</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">h</span><span class="token punctuation">(</span>App<span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function">mounted</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    document<span class="token punctuation">.</span><span class="token function">dispatchEvent</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Event</span><span class="token punctuation">(</span><span class="token string">'render-event'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// 添加这一行代码</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">$mount</span><span class="token punctuation">(</span><span class="token string">'#app'</span><span class="token punctuation">)</span>
</code></pre></div><ol start="80"><li>问题：scrollTo() 在 activated() 生命周期呢无法滚动到底部<br> <strong>描述</strong>：页面结构为 tab + content，样式结构如下，在设置了 position: absolute 的组件内（也就是 inner-content 对应的组件），activated 生命周期设置 scrollTo(0, top)，(top 等于内容到底部需要偏移的高度)，但是总会偏离 tab 高度（离滚动到底部的距离）<br> <strong>解决方法</strong>：在设置了 position:absolute 的元素同时也设置 height: 100%。</li></ol> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.content</span> <span class="token punctuation">{</span>
  flex=1<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.inner-content</span> <span class="token punctuation">{</span>
    <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span> // 这个设置十分重要
    <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
    <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
    <span class="token property">z-index</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>
    <span class="token property">overflow-x</span><span class="token punctuation">:</span> hide<span class="token punctuation">;</span>
    <span class="token property">overflow-y</span><span class="token punctuation">:</span> auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="81"><li>保持页面滚动高度的方法</li></ol> <p>(1) 在跳转新页面的时候进行设置</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 如果使用了betterscroll，设置如下</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>scrollY <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>scroll<span class="token punctuation">.</span><span class="token function">getScrollY</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token comment">// 普通跳转，传入特定class的方式</span>
<span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>wrapperClass <span class="token operator">=</span> <span class="token string">'home-page'</span>
</code></pre></div><p>（2）在 beforeEach 里面进行同意进行处理</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>from<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>scrollY<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  from<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>top <span class="token operator">=</span> from<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>scrollY
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>from<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>wrapperClass<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> routerElm <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.'</span> <span class="token operator">+</span> from<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>wrapperClass<span class="token punctuation">)</span>
  <span class="token keyword">let</span> scrollTop <span class="token operator">=</span> routerElm <span class="token operator">&amp;&amp;</span> routerElm<span class="token punctuation">.</span>scrollTop
  from<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>top <span class="token operator">=</span> scrollTop
<span class="token punctuation">}</span>
</code></pre></div><p>（3）在 activated 里面进行处理</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 普通情况</span>
<span class="token function">activated</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> top <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>top
    <span class="token keyword">if</span> <span class="token punctuation">(</span>top <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>keepAlive<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> routerElm <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.home-page'</span><span class="token punctuation">)</span>
      routerElm<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> top<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 使用了betterscroll，如果scroll组件里面的 activated 设置了`this.refresh()`，那么组件里面的更新必须延迟处理</span>
<span class="token function">activated</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> top <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>top
    <span class="token keyword">if</span> <span class="token punctuation">(</span>top <span class="token operator">&amp;&amp;</span> <span class="token keyword">this</span><span class="token punctuation">.</span>$route<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>keepAlive<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>$refs<span class="token punctuation">.</span>scroll<span class="token punctuation">.</span><span class="token function">scrollTo</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> top<span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span> <span class="token comment">// 延迟20ms</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="82"><li>处理回车的显示</li></ol> <ul><li>通过 js 处理</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>content<span class="token punctuation">&quot;</span></span> <span class="token attr-name">v-html</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tip<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">let</span> <span class="token function-variable function">toBr</span> <span class="token operator">=</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">tip</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 首先转换为数组</span>
    <span class="token keyword">let</span> arr <span class="token operator">=</span> tip<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> arr<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">charCodeAt</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'&lt;/br&gt;'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    tip <span class="token operator">=</span> arr<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> tip
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ul><li>通过 css 处理</li></ul> <div class="language-css extra-class"><pre class="language-css"><code><span class="token property">white-space</span><span class="token punctuation">:</span> pre-wrap<span class="token punctuation">;</span>
</code></pre></div><ol start="83"><li>当 btns 里面没有按钮时设置不显示</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token literal-property property">methods</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token function">setBtnShow</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">let</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'.buy-order-btns'</span><span class="token punctuation">)</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>btn <span class="token operator">&amp;&amp;</span> btn<span class="token punctuation">.</span>children <span class="token operator">&amp;&amp;</span> btn<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>showBtns <span class="token operator">=</span> <span class="token boolean">true</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>showBtns <span class="token operator">=</span> <span class="token boolean">false</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token literal-property property">watch</span><span class="token operator">:</span> <span class="token punctuation">{</span>
  <span class="token function">detail</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setBtnShow</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="84"><li>图片懒加载的原理</li></ol> <ul><li>首先不设置 src 属性，将图片地址放在 data-src 上面</li> <li>获取所有的懒加载的图片 list</li> <li>监听滚动事件，当图片出现在可视区域时，将 data-src 的地址设置为 src 的地址，然后将已显示的图片从 list 中去除</li> <li>当懒加载图片显示完毕以后，清除滚动事件</li></ul> <div class="language-html extra-class"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> imgList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
      delay<span class="token punctuation">,</span>
      time <span class="token operator">=</span> <span class="token number">50</span><span class="token punctuation">,</span>
      offset <span class="token operator">=</span> <span class="token number">0</span>
    <span class="token keyword">function</span> <span class="token function">_delay</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//函数防抖</span>
      <span class="token function">clearTimeout</span><span class="token punctuation">(</span>delay<span class="token punctuation">)</span>
      delay <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">_loadImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span> time<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">_loadImg</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//执行图片加载</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> imgList<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">_isShow</span><span class="token punctuation">(</span>imgList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// 如果再在可视区就设置src，然后将img从list里面移除</span>
          imgList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>src <span class="token operator">=</span> imgList<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">'data-src'</span><span class="token punctuation">)</span>
          imgList<span class="token punctuation">.</span><span class="token function">splice</span><span class="token punctuation">(</span>i<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
          <span class="token comment">// 如果懒加载完成，就清除调监听事件</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>imgList<span class="token punctuation">.</span>length <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            window<span class="token punctuation">.</span><span class="token function">removeEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span> _delay<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
          <span class="token punctuation">}</span>
          <span class="token comment">// 因为上面用的是splice，这儿必须要--</span>
          i<span class="token operator">--</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">function</span> <span class="token function">_isShow</span><span class="token punctuation">(</span><span class="token parameter">el</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//判断img是否出现在可视窗口</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>el<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span>
      <span class="token punctuation">}</span>
      <span class="token keyword">let</span> coords <span class="token operator">=</span> el<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token comment">// 图片距离可视窗口顶部的高度小于可视窗口的高度时为true，否则为false</span>
      <span class="token keyword">return</span> <span class="token punctuation">(</span>
        <span class="token punctuation">(</span>coords<span class="token punctuation">.</span>left <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> coords<span class="token punctuation">.</span>left <span class="token operator">&gt;=</span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> coords<span class="token punctuation">.</span>top<span class="token punctuation">)</span> <span class="token operator">&lt;=</span>
        <span class="token punctuation">(</span>document<span class="token punctuation">.</span>documentElement<span class="token punctuation">.</span>clientHeight <span class="token operator">||</span> window<span class="token punctuation">.</span>innerHeight<span class="token punctuation">)</span> <span class="token operator">+</span>
          <span class="token function">parseInt</span><span class="token punctuation">(</span>offset<span class="token punctuation">)</span>
      <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">function</span> <span class="token function">imgLoad</span><span class="token punctuation">(</span><span class="token parameter">selector</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//获取所有需要实现懒加载图片对象引用并设置window监听事件scroll</span>
      _selector <span class="token operator">=</span> selector <span class="token operator">||</span> <span class="token string">'.imgLazyLoad'</span>
      <span class="token keyword">let</span> nodes <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span>selector<span class="token punctuation">)</span>
      <span class="token comment">// 获取所有懒加载的图片</span>
      imgList <span class="token operator">=</span> <span class="token function">Array</span><span class="token punctuation">.</span><span class="token function">apply</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">,</span> nodes<span class="token punctuation">)</span>
      window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'scroll'</span><span class="token punctuation">,</span> _delay<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token function">imgLoad</span><span class="token punctuation">(</span><span class="token string">'.imgLazyLoad'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre></div><ol start="85"><li>html2canvas 要在 ios 上面生效，需要使用 1.0.0-rc.4 的版本</li> <li>lodash 按需加载
<code>import throttle from 'lodash/throttle'</code></li> <li>没有必要不要引入 moment.js</li> <li>ios 使用 html2canvas 截图时，里面的图片不生效</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 首先引入默认图片</span>
<span class="token keyword">import</span> avatar <span class="token keyword">from</span> <span class="token string">'@/assets/avatar.png'</span>

<span class="token comment">// 然后转换为base64</span>
<span class="token function">getURLBase64</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>headPic<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  avatarImg<span class="token punctuation">.</span>value <span class="token operator">=</span> res
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol start="89"><li>vue3 里面通过 /redirect 的方式在 ios 产生历史记录，为了避免刷新后无法返回到上一个页面，引入 window.history.length</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>router<span class="token punctuation">.</span>hasHistory <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>isIOS <span class="token operator">&amp;&amp;</span> window<span class="token punctuation">.</span>history<span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  router<span class="token punctuation">.</span>hasHistory <span class="token operator">=</span> <span class="token boolean">true</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">path</span><span class="token operator">:</span> <span class="token string">'/redirectPage'</span><span class="token punctuation">,</span>
    <span class="token literal-property property">query</span><span class="token operator">:</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">path</span><span class="token operator">:</span> to<span class="token punctuation">.</span>path<span class="token punctuation">,</span>
      <span class="token operator">...</span>to<span class="token punctuation">.</span>query<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>Cookies<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'X-JWT'</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span>Storage<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'userInfo'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>to<span class="token punctuation">.</span>meta<span class="token punctuation">.</span>ignoreLogin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token function">next</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="90"><li>ios 通过 input，type=file 触发打开文件，该 input 必须添加到 dom 里面，否则，无法检测到 change 事件</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">localUpload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Promise</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">resolve</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> input <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'input'</span><span class="token punctuation">)</span>
    input<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'type'</span><span class="token punctuation">,</span> <span class="token string">'file'</span><span class="token punctuation">)</span>
    input<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'accept'</span><span class="token punctuation">,</span> <span class="token string">'image/*'</span><span class="token punctuation">)</span>
    multiple <span class="token operator">&amp;&amp;</span> input<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">'multiple'</span><span class="token punctuation">,</span> multiple<span class="token punctuation">)</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token comment">// 添加到body里面</span>
    input<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'change'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> files <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>event<span class="token punctuation">.</span>target<span class="token punctuation">.</span>files<span class="token punctuation">]</span>
      <span class="token keyword">const</span> <span class="token punctuation">{</span> length <span class="token punctuation">}</span> <span class="token operator">=</span> files
      <span class="token keyword">const</span> fileList <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
      loading<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token boolean">true</span>
      files<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">file</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token function">upload2Cos</span><span class="token punctuation">(</span>featureName<span class="token punctuation">,</span> file<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> data <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          fileList<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>fileList<span class="token punctuation">.</span>length <span class="token operator">===</span> length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">resolve</span><span class="token punctuation">(</span>fileList<span class="token punctuation">)</span>
            document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>input<span class="token punctuation">)</span> <span class="token comment">// 移除input</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    input<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="91"><li>ios 端 input 的 change 里面无法触发 alert，但是可以触发 console</li> <li>vue 页面过渡时的动画设置
.right2l-enter-from 设置进入的页面
.right2l-leave-to 设置离开的页面
为了形成进入的页面压住出去的页面的动画，设置不同的偏移距离</li></ol> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.right2l-enter-from</span> <span class="token punctuation">{</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3d</span><span class="token punctuation">(</span>100%<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.right2l-leave-to</span> <span class="token punctuation">{</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3d</span><span class="token punctuation">(</span>-30%<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>返回的动画同理</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.right2lback-enter-from</span> <span class="token punctuation">{</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3d</span><span class="token punctuation">(</span>-30%<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">z-index</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.right2lback-leave-to</span> <span class="token punctuation">{</span>
  <span class="token property">transform</span><span class="token punctuation">:</span> <span class="token function">translate3d</span><span class="token punctuation">(</span>100%<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">z-index</span><span class="token punctuation">:</span> 999<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>过渡的时长必须一致</p> <div class="language-css extra-class"><pre class="language-css"><code><span class="token selector">.right2l-enter-active,
.right2lback-enter-active,
.right2l-leave-active,
.right2lback-leave-active</span> <span class="token punctuation">{</span>
  <span class="token property">width</span><span class="token punctuation">:</span> 100vw<span class="token punctuation">;</span>
  <span class="token property">transition</span><span class="token punctuation">:</span> all 0.2s linear<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="93"><li>实现在小程序里面跳转到微信公众号（小程序里面实现长按识别二位码的动能）</li></ol> <p>（1）通过微信公众号配置一篇文章;<br>
（2）文章里面包含可以识别的公众号二维码;<br>
（3）然后将这边文章的永久地址嵌入到小程序的 web-view 中</p> <ol start="94"><li>小程序 web-view</li></ol> <p>（1）通过小程序的 wx.getSystemInfoSync() 方法获取到安全区的距离</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> systemMsg <span class="token operator">=</span> wx<span class="token punctuation">.</span><span class="token function">getSystemInfoSync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> safeBottom <span class="token operator">=</span> systemMsg<span class="token punctuation">.</span>screenHeight <span class="token operator">-</span> systemMsg<span class="token punctuation">.</span>safeArea<span class="token punctuation">.</span>bottom
</code></pre></div><p>（2）将安全区的底部距离通过地址传给 web-view</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> url <span class="token operator">=</span> <span class="token string">'https://dev-hg.huangjinx.com/#/'</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>safeBottom <span class="token operator">!==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 此时说明是全面屏</span>
  url <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">?isFullScreen=true&amp;adaptSafeBottom=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>safeBottom<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span>
</code></pre></div><ol start="95"><li>html 和 js 添加 版本号</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">// vue.config.js</span>
<span class="token keyword">const</span> packageInfo <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./package.json'</span><span class="token punctuation">)</span>
<span class="token comment">// 版本号</span>
<span class="token keyword">const</span> <span class="token constant">VERSION</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">version-</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>packageInfo<span class="token punctuation">.</span>version<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span>

config<span class="token punctuation">.</span>plugins <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token operator">...</span>config<span class="token punctuation">.</span>plugins<span class="token punctuation">,</span>
  <span class="token keyword">new</span> <span class="token class-name">webpack<span class="token punctuation">.</span>BannerPlugin</span><span class="token punctuation">(</span><span class="token constant">VERSION</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 在js里面添加版本号</span>
<span class="token punctuation">]</span>

config<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span><span class="token string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">tap</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">args</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cdn <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
  <span class="token comment">// cdn css 无论在本地还是生产，都会注入</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>cdn<span class="token punctuation">.</span>css<span class="token punctuation">.</span>length<span class="token punctuation">)</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cdn<span class="token punctuation">.</span>css <span class="token operator">=</span> cdn<span class="token punctuation">.</span>css
  <span class="token comment">// 注入cdn</span>
  args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cdn <span class="token operator">=</span> cdn
  <span class="token comment">// 添加版本号</span>
  args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>version <span class="token operator">=</span> <span class="token constant">VERSION</span>
  <span class="token keyword">return</span> args
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><div class="language-html extra-class"><pre class="language-html"><code><span class="token comment">&lt;!-- &lt;%= htmlWebpackPlugin.options.version %&gt; --&gt;</span>
<span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
// ...
</code></pre></div><ol start="96"><li>h5 去小程序
通过 v-html 的形式替换按钮：</li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  miniInnerHtml<span class="token punctuation">.</span>value <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;wx-open-launch-weapp
    id=&quot;launch-btn&quot;
    username=&quot;gh_c32f2bd0c957&quot;
    path=&quot;pages/index/index&quot;
  &gt;
    &lt;template&gt;
      &lt;div class=&quot;back-home-btn&quot; style=&quot;color: rgba(195, 37, 45, 1); line-height: 48px; text-align: center; width: 160px;&quot;&gt;回到首页&lt;/div&gt;
    &lt;/template&gt;
  &lt;/wx-open-launch-weapp&gt;</span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
</code></pre></div><ol start="97"><li>判断是否是微信小程序 webview</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> __WX_MINI__ <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">miniprogram</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>
  navigator<span class="token punctuation">.</span>userAgent<span class="token punctuation">.</span><span class="token function">toLocaleLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span>
</code></pre></div><ol start="98"><li>从微信小程序的 webview 跳转小程序页面</li></ol> <div class="language-javascript extra-class"><pre class="language-javascript"><code>wx<span class="token punctuation">.</span>miniProgram<span class="token punctuation">.</span><span class="token function">navigateTo</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">'/pages/authGuidance/authGuidance'</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre></div><ol start="99"><li>inputmode</li></ol> <div class="language- extra-class"><pre class="language-text"><code>&lt;input
  class=&quot;add-weight fs28&quot;
  type=&quot;number&quot;
  inputmode=&quot;decimal&quot;
  v-model=&quot;evaluateWeight&quot;
  placeholder=&quot;请填写&quot;
/&gt;
</code></pre></div><p>inputmode：指定浏览器显示哪种键盘</p> <ol start="100"><li>will-change</li></ol> <div class="language-css extra-class"><pre class="language-css"><code><span class="token property">will-change</span><span class="token punctuation">:</span> transform<span class="token punctuation">;</span>
</code></pre></div><p>告知浏览器该元素会有哪些变化，使浏览器提前做好优化准备，增强页面渲染性能。</p> <ol start="101"><li><p>ipad 官网动画实现思路
<img src="https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/4ae1ce72e8214533af3cab1341980396~tplv-k3u1fbpfcp-watermark.image" alt="WeChat1d070a33cf403c898b17aa3ba0bbccdd.png"></p></li> <li><p>wx-open-launch-weapp 跳转小程序失败
在微信开发者工具里面，首先看有没有获得微信 JSDK 的的权限，在控制台会打印一个表格。</p></li></ol> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">getOpenLaunchWeapp</span><span class="token punctuation">(</span><span class="token parameter">path</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>__WX__<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;wx-open-launch-weapp
    username=&quot;gh_c32f2bd0c957&quot;
    style=&quot;display:block; width:100%;height:100%;position:absolute;left:0;top:0;overflow:hidden&quot;
    path=&quot;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>path<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&quot;
  &gt;
    &lt;script type=&quot;text/wxtag-template&quot;&gt;
      &lt;style&gt;
        .btn{
          width:100%;
          height: 1000px;
        }
      &lt;/style&gt;
      &lt;div class=&quot;btn&quot;&gt;
      &lt;/div&gt;
    &lt;/script&gt;

  &lt;/wx-open-launch-weapp&gt;</span><span class="token template-punctuation string">`</span></span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">''</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div></div> <footer class="page-edit" style="display:none;"><!----> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">1 年前</span></div></footer> <!----> <!----> <!----></main> <!----></div></div></div></div><div class="global-ui"><div class="back-to-ceiling" style="right:1rem;bottom:6rem;width:2.5rem;height:2.5rem;border-radius:.25rem;line-height:2.5rem;display:none;" data-v-c6073ba8 data-v-c6073ba8><svg t="1574745035067" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5404" class="icon" data-v-c6073ba8><path d="M526.60727968 10.90185116a27.675 27.675 0 0 0-29.21455937 0c-131.36607665 82.28402758-218.69155461 228.01873535-218.69155402 394.07834331a462.20625001 462.20625001 0 0 0 5.36959153 69.94390903c1.00431239 6.55289093-0.34802892 13.13561351-3.76865779 18.80351572-32.63518765 54.11355614-51.75690182 118.55860487-51.7569018 187.94566865a371.06718723 371.06718723 0 0 0 11.50484808 91.98906777c6.53300375 25.50556257 41.68394495 28.14064038 52.69160883 4.22606766 17.37162448-37.73630017 42.14135425-72.50938081 72.80769204-103.21549295 2.18761121 3.04276886 4.15646224 6.24463696 6.40373557 9.22774369a1871.4375 1871.4375 0 0 0 140.04691725 5.34970492 1866.36093723 1866.36093723 0 0 0 140.04691723-5.34970492c2.24727335-2.98310674 4.21612437-6.18497483 6.3937923-9.2178004 30.66633723 30.70611158 55.4360664 65.4791928 72.80769147 103.21549355 11.00766384 23.91457269 46.15860503 21.27949489 52.69160879-4.22606768a371.15156223 371.15156223 0 0 0 11.514792-91.99901164c0-69.36717486-19.13165746-133.82216804-51.75690182-187.92578088-3.42062944-5.66790279-4.76302748-12.26056868-3.76865837-18.80351632a462.20625001 462.20625001 0 0 0 5.36959269-69.943909c-0.00994388-166.08943902-87.32547796-311.81420293-218.6915546-394.09823051zM605.93803103 357.87693858a93.93749974 93.93749974 0 1 1-187.89594924 6.1e-7 93.93749974 93.93749974 0 0 1 187.89594924-6.1e-7z" p-id="5405" data-v-c6073ba8></path><path d="M429.50777625 765.63860547C429.50777625 803.39355007 466.44236686 1000.39046097 512.00932183 1000.39046097c45.56695499 0 82.4922232-197.00623328 82.5015456-234.7518555 0-37.75494459-36.9345906-68.35043303-82.4922232-68.34111062-45.57627738-0.00932239-82.52019037 30.59548842-82.51086798 68.34111062z" p-id="5406" data-v-c6073ba8></path></svg></div><canvas id="vuepress-canvas-cursor"></canvas><div></div></div></div>
    <script src="/myBlog/assets/js/app.abc56468.js" defer></script><script src="/myBlog/assets/js/3.ea42afb7.js" defer></script><script src="/myBlog/assets/js/1.28d3c41f.js" defer></script><script src="/myBlog/assets/js/36.5885b136.js" defer></script>
  </body>
</html>
